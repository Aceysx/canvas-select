!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).CanvasSelect=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};function e(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}function i(t,e,i,a){return new(i||(i=Promise))((function(n,r){function o(t){try{c(a.next(t))}catch(t){r(t)}}function s(t){try{c(a.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}c((a=a.apply(t,e||[])).next())}))}function a(t,e){var i,a,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,a&&(n=2&r[0]?a.return:r[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,r[1])).done)return n;switch(a=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],a=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function n(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,n,r=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return o}function r(t,e){for(var i=0,a=e.length,n=t.length;i<a;i++,n++)t[n]=e[i];return t}var o=function(t,e,i,a){this.label="",this.coor=[],this.strokeStyle="",this.fillStyle="",this.labelFillStyle="",this.labelFont="",this.active=!1,this.creating=!1,this.dragging=!1,this.uuid=function(){for(var t=[],e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}();var n=i.strokeStyle,r=i.fillStyle,o=i.labelFillStyle,s=i.labelFont;this.index=t,this.label=e,this.strokeStyle=n,this.fillStyle=r,this.labelFillStyle=o,this.labelFont=s,a&&(this.uuid=a)},s=function(t){function i(e,i,a,n,r){void 0===n&&(n={});var o=t.call(this,i,a,n,r)||this;return o.type=1,o.coor=e,o}return e(i,t),Object.defineProperty(i.prototype,"ctrlsData",{get:function(){var t=n(this.coor,2),e=n(t[0],2),i=e[0],a=e[1],r=n(t[1],2),o=r[0],s=r[1];return[[i,a],[i+(o-i)/2,a],[o,a],[o,a+(s-a)/2],[o,s],[i+(o-i)/2,s],[i,s],[i,a+(s-a)/2]]},enumerable:!1,configurable:!0}),i}(o),c=function(t){function i(e,i,a,n,r){void 0===n&&(n={});var o=t.call(this,i,a,n,r)||this;return o.type=2,o.coor=e,o}return e(i,t),Object.defineProperty(i.prototype,"ctrlsData",{get:function(){return this.coor.length>2?this.coor:[]},enumerable:!1,configurable:!0}),i}(o),l=function(t){function i(e,i,a,n,r){void 0===n&&(n={});var o=t.call(this,i,a,n,r)||this;return o.type=3,o.coor=e,o}return e(i,t),i}(o),h=function(){function t(){this._eventTree={}}return t.prototype.on=function(t,e){var i=this._eventTree[t];Array.isArray(i)?i.push(e):this._eventTree[t]=[e]},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var a=this._eventTree[t];Array.isArray(a)&&a.forEach((function(t){return t.apply(void 0,r([],n(e)))}))},t.prototype.off=function(t,e){var i=this._eventTree[t],a=i.find((function(t){return t===e}));Array.isArray(i)&&a&&i.splice(a,1)},t}();return function(t){function r(e,i){var a=t.call(this)||this;a.lock=!1,a.MIN_WIDTH=10,a.MIN_HEIGHT=10,a.strokeStyle="rgb(0, 0, 255)",a.fillStyle="rgba(0, 0, 255,0.1)",a.activeStrokeStyle="#f00",a.activeFillStyle="rgba(255, 0, 0,0.1)",a.ctrlStrokeStyle="#000",a.ctrlFillStyle="#fff",a.ctrlRadius=3,a.labelFillStyle="#fff",a.labelFont="12px serif #000",a.labelMaxLen=5,a.dataset=[],a.remmberOrigin=[0,0],a.createType=0,a.ctrlIndex=-1,a.cursor="auto",a.image=new Image,a.originX=0,a.originY=0,a.scaleStep=0;var n="string"==typeof e?document.querySelector(e):e;return Object.prototype.toString.call(n).includes("HTMLCanvasElement")?(a.canvas=n,a.ctx=a.canvas.getContext("2d"),a.WIDTH=a.canvas.clientWidth,a.HEIGHT=a.canvas.clientHeight,a.offlineCanvas=document.createElement("canvas"),a.offlineCanvas.width=a.WIDTH,a.offlineCanvas.height=a.HEIGHT,a.offlineCtx=a.offlineCanvas.getContext("2d"),a.initScreen(),i&&(a.image.src=i)):console.warn("HTMLCanvasElement is required!"),a}return e(r,t),Object.defineProperty(r.prototype,"activeShape",{get:function(){return this.dataset.find((function(t){return t.active}))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this.IMAGE_ORIGIN_WIDTH&&this.IMAGE_WIDTH?this.IMAGE_WIDTH/this.IMAGE_ORIGIN_WIDTH:1},enumerable:!1,configurable:!0}),r.prototype.initScreen=function(){var t=this;this.canvas.style.userSelect="none",this.canStart=new Promise((function(e){t.imageLoaded?e(!0):t.image.addEventListener("load",(function(){t.emit("load"),t.IMAGE_ORIGIN_WIDTH=t.IMAGE_WIDTH=t.image.width,t.IMAGE_ORIGIN_HEIGHT=t.IMAGE_HEIGHT=t.image.height,t.fitZoom(),e(!0)}))})),this.canvas.addEventListener("contextmenu",(function(e){t.lock||e.preventDefault()})),this.canvas.addEventListener("mousewheel",(function(e){if(!t.lock){e.preventDefault(),t.setScale(e.deltaY<0);var i=e.offsetX/t.scale,a=e.offsetY/t.scale;t.movePoint=[i,a],t.update()}})),this.canvas.addEventListener("mousedown",(function(e){var i,a=e.offsetX/t.scale,r=e.offsetY/t.scale,o=[e.offsetX,e.offsetY];if(!t.lock)if(2===e.buttons)t.remmberOrigin=[e.offsetX-t.originX,e.offsetY-t.originY];else if(1===e.buttons){var h=t.activeShape,f=(null==h?void 0:h.ctrlsData)||[];if(t.ctrlIndex=f.findIndex((function(e){return t.isPointInCircle(o,e,t.ctrlRadius)})),t.ctrlIndex>-1){var u=n(f[t.ctrlIndex],2),p=u[0],v=u[1];return void(t.remmber=[[a-p,r-v]])}var d=n(t.hoverOnShape(o),2),I=d[0],y=d[1],S=2===(null===(i=t.activeShape)||void 0===i?void 0:i.type)&&t.activeShape.creating;if(!S&&I>-1){if(t.emit("select",y),t.dataset.forEach((function(t,e){t.active=e===I})),y.dragging=!0,t.dataset.splice(I,1),t.dataset.push(y),t.remmber=[],3===y.type){var g=n(y.coor,2),b=g[0],H=g[1];t.remmber=[[a-b,r-H]]}else y.coor.forEach((function(e){t.remmber.push([a-e[0],r-e[1]])}));t.update()}else if(S){if(t.isInContent(e)){var m=t.activeShape,x=n(m.coor[m.coor.length-1],2);b=x[0],H=x[1];b!==a&&H!==r&&(m.coor.push([a-t.originX/t.scale,r-t.originY/t.scale]),t.update())}}else if(t.createType&&t.isInContent(e)){var T=void 0,E=[a-t.originX/t.scale,r-t.originY/t.scale];1===t.createType?(T=new s([E,E],t.dataset.length)).creating=!0:2===t.createType?(T=new c([E],t.dataset.length)).creating=!0:3===t.createType&&(T=new l(E,t.dataset.length),t.emit("add",T)),t.dataset.forEach((function(t){t.active=!1})),T.active=!0,t.dataset.push(T),t.emit("updated",T),t.update()}else t.activeShape&&(t.activeShape.active=!1,t.update())}})),this.canvas.addEventListener("mousemove",(function(e){var i,a,r=e.offsetX/t.scale,o=e.offsetY/t.scale;if(!t.lock)if(t.movePoint=[r,o],2===e.buttons&&3===e.which)t.originX=e.offsetX-t.remmberOrigin[0],t.originY=e.offsetY-t.remmberOrigin[1],t.update();else if(1===e.buttons){if(t.activeShape){if(t.ctrlIndex>-1&&t.isInContent(e)){var s=n(t.remmber,1),c=n(s[0],2),l=c[0],h=c[1];if(1===t.activeShape.type){var f=n(t.activeShape.coor,2),u=n(f[0],2),p=u[0],v=u[1],d=n(f[1],2),I=d[0],y=d[1],S=[];switch(t.ctrlIndex){case 0:S=[[r-l,o-h],[I,y]];break;case 1:S=[[p,o-h],[I,y]];break;case 2:S=[[p,o-h],[r-l,y]];break;case 3:S=[[p,v],[r-l,y]];break;case 4:S=[[p,v],[r-l,o-h]];break;case 5:S=[[p,v],[I,o-h]];break;case 6:S=[[r-l,v],[I,o-h]];break;case 7:S=[[r-l,v],[I,y]]}var g=n(S,2),b=n(g[0],2),H=b[0],m=b[1],x=n(g[1],2),T=x[0],E=x[1];T-H>=t.MIN_WIDTH&&E-m>=t.MIN_HEIGHT?t.activeShape.coor=S:t.emit("error","宽不能小于".concat(t.MIN_WIDTH,",高不能小于").concat(t.MIN_HEIGHT,"。"))}else 2===t.activeShape.type&&t.activeShape.coor.splice(t.ctrlIndex,1,[r-t.originX/t.scale,o-t.originY/t.scale]);t.update()}else if(t.activeShape.dragging){S=[];var G=t.IMAGE_ORIGIN_WIDTH||t.WIDTH,M=t.IMAGE_ORIGIN_HEIGHT||t.HEIGHT;if(3===t.activeShape.type){var _=n(t.remmber[0],2),k=_[0];h=o-_[1];if((l=r-k)<0||l>G||h<0||h>M)return;S=[l,h]}else for(var w=0;w<t.activeShape.coor.length;w++){var D=t.remmber[w];l=r-D[0],h=o-D[1];if(l<0||l>G||h<0||h>M)return;S.push([l,h])}t.activeShape.coor=S,t.update()}else if(t.activeShape.creating&&1===t.activeShape.type&&t.isInContent(e)){l=r-t.originX/t.scale,h=o-t.originY/t.scale;t.activeShape.coor.splice(1,1,[l,h])}t.emit("updated",t.activeShape)}t.update()}else 2===(null===(i=t.activeShape)||void 0===i?void 0:i.type)&&(null===(a=t.activeShape)||void 0===a?void 0:a.creating)&&t.update()})),this.canvas.addEventListener("mouseup",(function(e){if(!t.lock&&(t.remmber=[],t.activeShape&&(t.activeShape.dragging=!1,t.activeShape.creating&&1===t.activeShape.type))){var i=n(t.activeShape.coor,2),a=n(i[0],2),r=a[0],o=a[1],s=n(i[1],2),c=s[0],l=s[1];Math.abs(r-c)<t.MIN_WIDTH||Math.abs(o-l)<t.MIN_HEIGHT?(t.dataset.pop(),t.emit("error","宽不能小于".concat(t.MIN_WIDTH,",高不能小于").concat(t.MIN_HEIGHT))):(t.activeShape.coor=[[Math.min(r,c),Math.min(o,l)],[Math.max(r,c),Math.max(o,l)]],t.activeShape.creating=!1,t.emit("add",t.activeShape)),t.update()}})),this.canvas.addEventListener("dblclick",(function(){var e;t.lock||2===(null===(e=t.activeShape)||void 0===e?void 0:e.type)&&t.activeShape.coor.length>2&&(t.emit("add",t.activeShape),t.activeShape.creating=!1,t.update())})),document.body.addEventListener("keyup",(function(e){t.lock||t.activeShape&&(2===t.activeShape.type?("Escape"===e.key?t.deleteByIndex(t.activeShape.index):"Backspace"===e.key&&(t.activeShape.coor.length>1&&t.activeShape.creating?t.activeShape.coor.pop():t.deleteByIndex(t.activeShape.index)),t.update()):t.activeShape&&"Backspace"===e.key&&t.deleteByIndex(t.activeShape.index))}))},r.prototype.setData=function(t){return i(this,void 0,void 0,(function(){var e,i=this;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.canStart];case 1:return a.sent(),t.forEach((function(t,e){if(Object.prototype.toString.call(t).indexOf("Object")>-1){var a=t.label,n=t.type,r=t.coor,o=t.strokeStyle,h=t.fillStyle,f=t.labelFillStyle,u=t.labelFont,p=t.uuid,v={strokeStyle:o,fillStyle:h,labelFillStyle:f,labelFont:u},d=void 0;switch(n){case 1:d=new s(r,e,a,v,p);break;case 2:d=new c(r,e,a,v,p);break;case 3:d=new l(r,e,a,v,p)}i.dataset.push(d)}else i.emit("error","".concat(t," in data must be an enumerable Object."))})),this.update(),[3,3];case 2:return e=a.sent(),this.emit("error",e),[3,3];case 3:return[2]}}))}))},r.prototype.hoverOnShape=function(t){var e=this,i=-1,a=this.dataset.reduceRight((function(a,n,r){return a||(3===n.type&&e.isPointInCircle(t,n.coor,3)||1===n.type&&e.isPointInRect(t,n.coor)||2===n.type&&e.isPointInPolygon(t,n.coor))&&(i=r,a=n),a}),null);return[i,a]},r.prototype.isInContent=function(t){var e=t.offsetX/this.scale,i=t.offsetY/this.scale;return e>=this.originX/this.scale&&i>=this.originY/this.scale&&e<=this.originX/this.scale+this.IMAGE_ORIGIN_WIDTH&&i<=this.originY/this.scale+this.IMAGE_ORIGIN_HEIGHT},r.prototype.isPointInRect=function(t,e){var i=this,a=n(t,2),r=a[0],o=a[1],s=n(e.map((function(t){return t.map((function(t){return t*i.scale}))})),2),c=n(s[0],2),l=c[0],h=c[1],f=n(s[1],2),u=f[0],p=f[1];return l+this.originX<=r&&r<=u+this.originX&&h+this.originY<=o&&o<=p+this.originY},r.prototype.isPointInPolygon=function(t,e){var i=this;this.offlineCtx.save(),this.offlineCtx.clearRect(0,0,this.WIDTH,this.HEIGHT),this.offlineCtx.translate(this.originX,this.originY),this.offlineCtx.beginPath(),e.forEach((function(t,e){var a=n(t.map((function(t){return Math.round(t*i.scale)})),2),r=a[0],o=a[1];0===e?i.offlineCtx.moveTo(r,o):i.offlineCtx.lineTo(r,o)})),this.offlineCtx.closePath(),this.offlineCtx.fill();var a=this.offlineCtx.getImageData(0,0,this.WIDTH,this.HEIGHT),r=(t[1]-1)*this.WIDTH*4+4*t[0];return this.offlineCtx.restore(),0!==a.data[r+3]},r.prototype.isPointInCircle=function(t,e,i){var a=this,r=n(t,2),o=r[0],s=r[1],c=n(e.map((function(t){return t*a.scale})),2),l=c[0],h=c[1];return Math.sqrt(Math.pow(l+this.originX-o,2)+Math.pow(h+this.originY-s,2))<=i},r.prototype.drawRect=function(t){var e=this;if(2===t.coor.length){var i=t.labelFillStyle,a=t.labelFont,r=t.strokeStyle,o=t.fillStyle,s=t.active,c=t.creating,l=t.coor,h=t.label,f=n(l.map((function(t){return t.map((function(t){return Math.round(t*e.scale)}))})),2),u=n(f[0],2),p=u[0],v=u[1],d=n(f[1],2),I=d[0],y=d[1];this.ctx.save(),this.ctx.fillStyle=o||this.fillStyle,this.ctx.strokeStyle=s||c?this.activeStrokeStyle:r||this.strokeStyle;var S=I-p,g=y-v;this.ctx.strokeRect(p,v,S,g),c||this.ctx.fillRect(p,v,S,g),this.ctx.restore(),this.drawLabel(l[0],h,i,a)}},r.prototype.drawPolygon=function(t){var e=this,i=t.labelFillStyle,a=t.labelFont,r=t.strokeStyle,o=t.fillStyle,s=t.active,c=t.creating,l=t.coor,h=t.label;if(this.ctx.save(),this.ctx.fillStyle=o||this.fillStyle,this.ctx.strokeStyle=s||c?this.activeStrokeStyle:r||this.strokeStyle,this.ctx.beginPath(),l.forEach((function(t,i){var a=n(t.map((function(t){return Math.round(t*e.scale)})),2),r=a[0],o=a[1];0===i?e.ctx.moveTo(r,o):e.ctx.lineTo(r,o)})),c){var f=n(this.movePoint.map((function(t){return Math.round(t*e.scale)})),2),u=f[0],p=f[1];this.ctx.lineTo(u-this.originX,p-this.originY)}else l.length>2&&this.ctx.closePath();this.ctx.fill(),this.ctx.stroke(),this.ctx.restore(),this.drawLabel(l[0],h,i,a)},r.prototype.drawDot=function(t){var e=this,i=t.labelFillStyle,a=t.labelFont,r=t.strokeStyle,o=t.fillStyle,s=t.active,c=t.coor,l=t.label,h=n(c.map((function(t){return t*e.scale})),2),f=h[0],u=h[1];this.ctx.save(),this.ctx.fillStyle=o||this.ctrlFillStyle,this.ctx.strokeStyle=s?this.activeStrokeStyle:r||this.strokeStyle,this.ctx.beginPath(),this.ctx.arc(f,u,this.ctrlRadius,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.arc(f,u,this.ctrlRadius,0,2*Math.PI,!0),this.ctx.stroke(),this.ctx.restore(),this.drawLabel(c,l,i,a)},r.prototype.drawCtrl=function(t){var e=this,i=n(t.map((function(t){return t*e.scale})),2),a=i[0],r=i[1];this.ctx.save(),this.ctx.beginPath(),this.ctx.fillStyle=this.ctrlFillStyle,this.ctx.strokeStyle=this.ctrlStrokeStyle,this.ctx.arc(a,r,this.ctrlRadius,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.arc(a,r,this.ctrlRadius,0,2*Math.PI,!0),this.ctx.stroke(),this.ctx.restore()},r.prototype.drawCtrlList=function(t){var e=this;t.ctrlsData.forEach((function(t){e.drawCtrl(t)}))},r.prototype.drawLabel=function(t,e,i,a){var r=this;if(void 0===e&&(e=""),void 0===i&&(i=""),void 0===a&&(a=""),e.length){var o=e.length<this.labelMaxLen+1?e:"".concat(e.substr(0,this.labelMaxLen),"..."),s=this.ctx.measureText(o),c=n(t.map((function(t){return t*r.scale})),2),l=c[0],h=c[1],f=this.IMAGE_ORIGIN_WIDTH-t[0]<(s.width+4)/this.scale,u=this.IMAGE_ORIGIN_HEIGHT-t[1]<16/this.scale;this.ctx.save(),this.ctx.fillStyle=i||this.labelFillStyle,this.ctx.fillRect(f?l-s.width-3:l+1,u?h-15:h+1,s.width+4,16),this.ctx.font=a||this.labelFont,this.ctx.strokeText(o,f?l-s.width-2:l+2,u?h-4:h+12,80),this.ctx.restore()}},r.prototype.paintImage=function(){this.ctx.drawImage(this.image,0,0,this.IMAGE_WIDTH,this.IMAGE_HEIGHT)},r.prototype.clear=function(){this.ctx.clearRect(0,0,this.WIDTH,this.HEIGHT)},r.prototype.update=function(){var t=this;this.ctx.save(),this.clear(),this.ctx.translate(this.originX,this.originY),this.paintImage(),this.dataset.forEach((function(e){switch(e.type){case 1:t.drawRect(e);break;case 2:t.drawPolygon(e);break;case 3:t.drawDot(e)}})),this.activeShape&&[1,2].includes(this.activeShape.type)&&this.drawCtrlList(this.activeShape),this.ctx.restore()},r.prototype.deleteByIndex=function(t){var e=this.dataset.findIndex((function(e){return e.index===t}));e>-1&&(this.emit("delete",this.dataset[e]),this.dataset.splice(e,1),this.dataset.forEach((function(t,e){t.index=e})),this.update())},r.prototype.calcStep=function(t){t&&(this.scaleStep=100,this.setScale(!1)),(this.IMAGE_WIDTH>this.WIDTH||this.IMAGE_HEIGHT>this.HEIGHT)&&(this.setScale(!1),this.calcStep())},r.prototype.setScale=function(t){if(!this.lock&&!(!t&&this.IMAGE_WIDTH<=20||t&&this.IMAGE_WIDTH>=100*this.WIDTH)){t?this.scaleStep++:this.scaleStep--;var e=Math.abs(this.scaleStep),i=this.IMAGE_WIDTH;this.IMAGE_WIDTH=Math.round(this.IMAGE_ORIGIN_WIDTH*Math.pow(this.scaleStep>=0?1.05:.95,e)),this.IMAGE_HEIGHT=Math.round(this.IMAGE_ORIGIN_HEIGHT*Math.pow(this.scaleStep>=0?1.05:.95,e)),this.stayPosition(this.IMAGE_WIDTH/i),this.update()}},r.prototype.fitZoom=function(){this.calcStep(!0),this.IMAGE_HEIGHT/this.IMAGE_WIDTH>=this.HEIGHT/this.WIDTH?(this.IMAGE_WIDTH=this.IMAGE_ORIGIN_WIDTH/(this.IMAGE_ORIGIN_HEIGHT/this.HEIGHT),this.IMAGE_HEIGHT=this.HEIGHT):(this.IMAGE_WIDTH=this.WIDTH,this.IMAGE_HEIGHT=this.IMAGE_ORIGIN_HEIGHT/(this.IMAGE_ORIGIN_WIDTH/this.WIDTH)),this.originX=(this.WIDTH-this.IMAGE_WIDTH)/2,this.originY=(this.HEIGHT-this.IMAGE_HEIGHT)/2,this.update()},r.prototype.stayPosition=function(t){this.originX=this.WIDTH/2-(this.WIDTH/2-this.originX)*t,this.originY=this.HEIGHT/2-(this.HEIGHT/2-this.originY)*t},r}(h)}));
//# sourceMappingURL=canvas-select.min.js.map
